{"version":3,"file":"main.js","mappings":"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","sources":["webpack:///../common/Settings.ts","webpack:///./src/ControlManager.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./src/lib-df-buttons.ts"],"sourcesContent":["\ndeclare global {\n\tinterface LenientGlobalVariableTypes {\n\t\tgame: never;\n\t\tcanvas: never;\n\t}\n\tinterface String {\n\t\t/** Localizes the string via the global `game.i18n.localize()` function. */\n\t\tlocalize(): string\n\t}\n\ttype AnyFunction = (...args: any) => any;\n}\n\nexport default class SETTINGS {\n\tstatic MOD_NAME: string;\n\tstatic init(moduleName: string) {\n\t\tthis.MOD_NAME = moduleName;\n\t\tif (!String.prototype.localize) {\n\t\t\tString.prototype.localize = function () {\n\t\t\t\treturn game.i18n.localize(this.valueOf());\n\t\t\t};\n\t\t}\n\t}\n\tstatic register<T>(key: string, config: ClientSettings.PartialSettingConfig<T>) { game.settings.register(SETTINGS.MOD_NAME, key, config); }\n\tstatic registerMenu(key: string, config: ClientSettings.PartialSettingSubmenuConfig) { game.settings.registerMenu(SETTINGS.MOD_NAME, key, config); }\n\tstatic get<T>(key: string): T { return <T>game.settings.get(SETTINGS.MOD_NAME, key); }\n\tstatic async set<T>(key: string, value: T): Promise<T> { return await game.settings.set(SETTINGS.MOD_NAME, key, value); }\n\tstatic default<T>(key: string): T { return <T>game.settings.settings.get(SETTINGS.MOD_NAME + '.' + key).default; }\n\t/** helper for referencing a Typed constructor for the `type` field of a setting { type: SETTINGS.typeOf<MyClass>() } */\n\tstatic typeOf<T>(): ConstructorOf<T> { return Object as any; }\n}\n","import SETTINGS from \"../../common/Settings\";\nimport { Tool, ToolGroup, ControlManager as IControlManager, Predicate, Handler } from \"./ToolType\";\n\ninterface ToolUI {\n\tname: string;\n\ttitle: string;\n\ticon: string;\n\tclass: string | false;\n\tactive: boolean;\n\tbutton: boolean;\n\ttoggle: boolean;\n}\n\ninterface ToolGroupUI extends ToolUI {\n\ttools: Partial<ToolUI>[];\n}\n\ntype CMData = {\n\tgroups: Partial<ToolGroupUI>[];\n\tsingleGroup: boolean;\n};\n\nexport default class ControlManager extends Application implements IControlManager {\n\tstatic async checkBoolean(field?: Predicate | boolean | null, invertFalsey = false): Promise<boolean> {\n\t\treturn field instanceof Function ? await field() :\n\t\t\t((invertFalsey && (field === null || field === undefined || field)) || (!invertFalsey && !!field));\n\t}\n\n\tprivate initializationIncomplete = false;\n\tprivate _groups: ToolGroup[];\n\tprivate magnetMenu: JQuery<HTMLElement> | null = null;\n\tprivate hooksRegister: Record<string, number> = {};\n\tget groups(): ToolGroup[] { return this._groups; }\n\tprivate _activeGroupName: string;\n\tget activeGroupName(): string { return this._activeGroupName; }\n\tset activeGroupName(value: string) { this._activeGroupName = value; }\n\n\tget activeToolName() {\n\t\tconst group = this.activeGroup;\n\t\treturn group ? group.activeTool : null;\n\t}\n\tget activeGroup() {\n\t\tif (!this.groups) return null;\n\t\treturn this.groups.find(c => c.name === this.activeGroupName) || null;\n\t}\n\tget activeTool() {\n\t\tconst group = this.activeGroup;\n\t\tif (!group) return null;\n\t\tconst tool = group.tools.find(t => t.name === group.activeTool);\n\t\treturn tool || null;\n\t}\n\tstatic get defaultOptions(): ApplicationOptions {\n\t\treturn mergeObject(super.defaultOptions, {\n\t\t\twidth: 100,\n\t\t\tid: \"moduleControls\",\n\t\t\ttemplate: `modules/lib-df-buttons/templates/controls.hbs`,\n\t\t\tpopOut: false,\n\t\t\tresizable: false,\n\n\t\t});\n\t}\n\n\tprivate static initializeFields(control: Tool) {\n\t\t// TODO: Remove this block in the future!\n\t\t//! Handle deprecated `active` field\n\t\tif ((<any>control).active !== undefined)\n\t\t\tcontrol.isActive = (<any>control).active;\n\t\t// TODO: END OF BLOCK\n\t\tcontrol.toggle = !!control.toggle;\n\t\tcontrol.button = !!control.button;\n\t\tcontrol.isActive = control.toggle ? (control.isActive ?? false) : false;\n\t\tcontrol.visible = control.visible ?? true;\n\t\tcontrol.onClick = control.onClick ?? null;\n\t}\n\n\tasync initialize() {\n\t\tthis._groups = <any>this._getModuleToolGroups();\n\t\tthis.activeGroupName = null;\n\t\t// Defer initialization completion to the first render call\n\t\tthis.initializationIncomplete = true;\n\t}\n\tprivate async completeInitialization() {\n\t\tthis.initializationIncomplete = false;\n\t\tthis.hooksRegister['collapseSidebarPre'] = Hooks.on('collapseSidebarPre', this._handleSidebarCollapse.bind(this));\n\t\tthis.hooksRegister['activateGroupByName'] = Hooks.on('activateGroupByName', this.activateGroupByName.bind(this));\n\t\tthis.hooksRegister['activateToolByName'] = Hooks.on('activateToolByName', this.activateToolByName.bind(this));\n\t\tthis.hooksRegister['reloadModuleButtons'] = Hooks.on('reloadModuleButtons', this.reloadModuleButtons.bind(this));\n\t\tthis.hooksRegister['refreshModuleButtons'] = Hooks.on('refreshModuleButtons', this.refresh.bind(this));\n\t\tthis.hooksRegister['renderSceneControls'] = Hooks.on('renderSceneControls', () => { this.refresh(); this._handleWindowResize(); });\n\t\tthis.hooksRegister['collapseSceneNavigation'] = Hooks.on('collapseSceneNavigation', this._handleWindowResize.bind(this));\n\t\tthis.hooksRegister['renderPlayerList'] = Hooks.on('renderPlayerList', this._handleWindowResize.bind(this));\n\t\twindow.addEventListener('resize', this._handleWindowResize.bind(this));\n\t\tfor (const group of this._groups) {\n\t\t\t// Initialize all unset fields to their defaults\n\t\t\tControlManager.initializeFields(group);\n\t\t\t// Detect if this group should be the default active group\n\t\t\tif (!this.activeGroupName && !group.toggle && !group.button && await ControlManager.checkBoolean(group.visible)) {\n\t\t\t\tthis.activeGroupName = group.name;\n\t\t\t\tgroup.isActive = true;\n\t\t\t\t// Notify the auto-selected group they are now selected\n\t\t\t\tconst currentGroup = this.activeGroup;\n\t\t\t\tthis._invokeHandler(currentGroup?.onClick, currentGroup, false);\n\t\t\t}\n\t\t\t// Initialize the tools for the group\n\t\t\tfor (const tool of (group.tools ?? [])) {\n\t\t\t\tControlManager.initializeFields(tool);\n\t\t\t\tif (!group.activeTool && !tool.toggle && !tool.button && await ControlManager.checkBoolean(tool.visible)) {\n\t\t\t\t\tgroup.activeTool = tool.name;\n\t\t\t\t\ttool.isActive = true;\n\t\t\t\t\t// Notify the auto-selected tool they are now selected\n\t\t\t\t\tconst currentTool = this.activeTool;\n\t\t\t\t\tthis._invokeHandler(currentTool?.onClick, currentTool, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trefresh(): void {\n\t\tthis.render();\n\t}\n\n\tprivate _getModuleToolGroups(): ToolGroup[] {\n\t\tconst groups: ToolGroup[] = [];\n\t\tHooks.callAll(`getModuleToolGroupsPre`, this, groups);\n\t\tHooks.callAll(`getModuleToolGroups`, this, groups);\n\t\tHooks.callAll(`getModuleToolGroupsPost`, this, groups);\n\t\treturn groups;\n\t}\n\n\tasync getData(_?: Application.RenderOptions): Promise<CMData> {\n\t\tif (this.groups.length == 0) return { groups: [], singleGroup: false };\n\t\tconst groups: ToolGroupUI[] = [];\n\t\tfor (const group of this._groups) {\n\t\t\tif (\n\t\t\t\t!await ControlManager.checkBoolean(group.visible, true) ||\n\t\t\t\t(game.settings.get('core', 'noCanvas') && !await ControlManager.checkBoolean(group.noCanvas, false))\n\t\t\t) continue;\n\t\t\tconst groupUI: ToolGroupUI = {\n\t\t\t\tname: group.name,\n\t\t\t\ticon: group.icon,\n\t\t\t\ttitle: group.title,\n\t\t\t\tbutton: group.button,\n\t\t\t\ttoggle: group.toggle,\n\t\t\t\tclass: group.class ?? false,\n\t\t\t\tactive: await ControlManager.checkBoolean(group.isActive),\n\t\t\t\ttools: []\n\t\t\t};\n\t\t\tfor (const tool of (group.tools ?? [])) {\n\t\t\t\tif (\n\t\t\t\t\t!await ControlManager.checkBoolean(tool.visible, true) ||\n\t\t\t\t\t(game.settings.get('core', 'noCanvas') && !await ControlManager.checkBoolean(group.noCanvas, false))\n\t\t\t\t) continue;\n\t\t\t\tgroupUI.tools.push({\n\t\t\t\t\tname: tool.name,\n\t\t\t\t\ticon: tool.icon,\n\t\t\t\t\ttitle: tool.title,\n\t\t\t\t\tbutton: tool.button,\n\t\t\t\t\ttoggle: tool.toggle,\n\t\t\t\t\tclass: tool.class ?? false,\n\t\t\t\t\tactive: await ControlManager.checkBoolean(tool.isActive)\n\t\t\t\t});\n\t\t\t}\n\t\t\tgroups.push(groupUI);\n\t\t}\n\t\tconst singleGroup = groups.length === 1 && !groups[0].button && !groups[0].toggle;\n\t\tif (groups.every(x => !x.active)) {\n\t\t\tconst firstGroup = groups.find(x => !x.button && !x.toggle);\n\t\t\tfirstGroup.active = true;\n\t\t\tif (firstGroup)\n\t\t\t\tthis.activateGroupByName(firstGroup.name);\n\t\t}\n\t\treturn { groups, singleGroup };\n\t}\n\n\t/** @inheritdoc */\n\tactivateListeners(html: JQuery<HTMLElement>) {\n\t\thtml.find('.control-tool[data-group]').on('click', this._onClickGroup.bind(this));\n\t\thtml.find('.control-tool[data-tool]').on('click', this._onClickTool.bind(this));\n\t\thtml.find('#magnet').on('click', async () => {\n\t\t\tif (this.magnetMenu) return;\n\t\t\tthis.magnetMenu = $(await renderTemplate(`/modules/${SETTINGS.MOD_NAME}/templates/magnet.hbs`, {}));\n\t\t\tthis.magnetMenu.find('button').on('click', async event => {\n\t\t\t\tthis.magnetMenu.remove();\n\t\t\t\tthis.magnetMenu = null;\n\t\t\t\tawait SETTINGS.set('position', event.currentTarget.classList[0]);\n\t\t\t});\n\t\t\tthis.magnetMenu.find('.close').on('click', () => {\n\t\t\t\tthis.magnetMenu.remove();\n\t\t\t\tthis.magnetMenu = null;\n\t\t\t});\n\t\t\t$('body').append(this.magnetMenu);\n\t\t});\n\t}\n\n\tprivate async _invokeHandler(handler: Handler<boolean> | null | undefined, owner: Tool, active?: boolean) {\n\t\tif (handler === null || handler === undefined) return;\n\t\tif (!handler.prototype) await handler(active);\n\t\telse await handler.bind(owner)(active);\n\t}\n\n\tprivate async _onClickGroup(event: JQuery.ClickEvent) {\n\t\tevent.preventDefault();\n\t\tconst li = event.currentTarget;\n\t\tconst groupName = li.dataset.group;\n\t\tconst group = this.groups.find(c => c.name === groupName);\n\t\t// Handle Toggles\n\t\tif (group.toggle) {\n\t\t\tconst newState = !await ControlManager.checkBoolean(group.isActive);\n\t\t\t// If the group's active state is not a function, use it to store state\n\t\t\tif (!(group.isActive instanceof Function))\n\t\t\t\tgroup.isActive = newState;\n\t\t\tthis._invokeHandler(group.onClick, group, newState);\n\t\t\t// Render the controls\n\t\t\tthis.refresh();\n\t\t}\n\t\t// Handle Buttons\n\t\telse if (group.button) {\n\t\t\tawait this._invokeHandler(group.onClick, group);\n\t\t}\n\t\t// Handle Groups\n\t\telse\n\t\t\tthis.activateGroupByName(groupName);\n\t}\n\tprivate async _onClickTool(event: JQuery.ClickEvent) {\n\t\tevent.preventDefault();\n\t\tconst li = event.currentTarget;\n\t\tconst group = this.activeGroup;\n\t\tconst toolName = li.dataset.tool;\n\t\tconst tool = group.tools.find(t => t.name === toolName);\n\t\t// Handle Toggles\n\t\tif (tool.toggle) {\n\t\t\tconst newState = !await ControlManager.checkBoolean(tool.isActive);\n\t\t\t// If the tool's active state is not a function, use it to store state\n\t\t\tif (!(tool.isActive instanceof Function))\n\t\t\t\ttool.isActive = newState;\n\t\t\tthis._invokeHandler(tool.onClick, tool, newState);\n\t\t\t// Render the controls\n\t\t\tthis.refresh();\n\t\t}\n\t\t// Handle Buttons\n\t\telse if (tool.button)\n\t\t\tthis._invokeHandler(tool.onClick, tool);\n\t\t// Handle Tools\n\t\telse\n\t\t\tthis.activateToolByName(this.activeGroupName, toolName, true);\n\t}\n\n\tprotected _injectHTML(html: JQuery<HTMLElement>): void {\n\t\t$('body').append(html);\n\t\tthis._element = html;\n\t}\n\n\tasync _render(force = false, options = {}): Promise<void> {\n\t\t// If initialization needs to be completed, invoke the completion\n\t\tif (this.initializationIncomplete) await this.completeInitialization();\n\t\tif (!game.ready) return;\n\t\tawait super._render(force, options);\n\t\tif ((<any>ui.sidebar)._collapsed) {\n\t\t\tthis.element.css('right', '35px');\n\t\t}\n\t\tthis.element[0].removeAttribute('class');\n\t\tthis.element[0].classList.add('app');\n\t\tswitch (SETTINGS.get('position')) {\n\t\t\tcase 'top': this.element[0].classList.add('top'); break;\n\t\t\tcase 'left': this.element[0].classList.add('left'); break;\n\t\t\tcase 'bottom': this.element[0].classList.add('bottom'); break;\n\t\t\tcase 'right': default: break;\n\t\t}\n\n\t\tthis._handleSidebarCollapse(ui.sidebar, (<any>ui.sidebar)._collapsed);\n\t\tthis._handleWindowResize();\n\t}\n\tclose(options?: Application.CloseOptions): Promise<void> {\n\t\tHooks.off('collapseSidebarPre', this.hooksRegister['collapseSidebarPre']);\n\t\tHooks.off('activateGroupByName', this.hooksRegister['activateGroupByName']);\n\t\tHooks.off('activateToolByName', this.hooksRegister['activateToolByName']);\n\t\tHooks.off('reloadModuleButtons', this.hooksRegister['reloadModuleButtons']);\n\t\tHooks.off('renderSceneControls', this.hooksRegister['renderSceneControls']);\n\t\tHooks.off('collapseSceneNavigation', this.hooksRegister['collapseSceneNavigation']);\n\t\tHooks.off('renderPlayerList', this.hooksRegister['renderPlayerList']);\n\t\twindow.removeEventListener('resize', this._handleWindowResize);\n\t\treturn super.close(options);\n\t}\n\n\tprivate _handleSidebarCollapse(sideBar: Sidebar, collapsed: boolean) {\n\t\tconst collapsedSize = '40px';\n\t\tconst expandedSize = '310px';\n\t\tconst shouldAnimate = collapsed ? sideBar.element[0].offsetWidth !== 32 : sideBar.element[0].offsetWidth !== 300;\n\t\tif (SETTINGS.get('position') !== 'right') {\n\t\t\tthis.element.css('right', 'unset');\n\t\t\treturn;\n\t\t}\n\t\tif (shouldAnimate) {\n\t\t\tif (collapsed) this.element.delay(250).animate({ right: collapsedSize }, 150);\n\t\t\telse this.element.animate({ right: expandedSize }, 150);\n\t\t}\n\t\telse this.element[0].style.right = collapsed ? collapsedSize : expandedSize;\n\t}\n\n\tprivate static readonly CONTROL_WIDTH = 38 + 5;\n\tprivate static readonly CONTROL_HEIGHT = 48;\n\n\tprivate getLeftWidth(): number {\n\t\t//? This may need to be reintroduced for ardittristan's Button Overflow module\n\t\t// const sceneLayers = document.querySelector<HTMLElement>('#controls > ol.main-controls.app.control-tools.flexcol');\n\t\t// max = Math.floor(sceneLayers.offsetHeight / ControlManager.CONTROL_WIDTH);\n\t\t// cols = Math.ceil(sceneLayers.childElementCount / max);\n\t\tlet cols = 1;\n\t\tconst sceneTools = document.querySelector<HTMLElement>('#controls > ol.sub-controls.app.control-tools.flexcol.active');\n\t\tconst max = Math.floor(sceneTools.offsetHeight / ControlManager.CONTROL_HEIGHT);\n\t\tcols += Math.ceil(sceneTools.childElementCount / max);\n\t\treturn cols * ControlManager.CONTROL_WIDTH + 20;\n\t}\n\tprivate getTopHeight(magnetToSceneControls: boolean): number {\n\t\tconst uiTop = document.querySelector<HTMLElement>('#ui-middle #ui-top #navigation');\n\t\tlet top = uiTop.offsetHeight + uiTop.offsetTop;\n\t\tif (magnetToSceneControls) {\n\t\t\tconst layers = document.querySelector<HTMLElement>('#ui-left > #controls > ol.main-controls.app.control-tools.flexcol');\n\t\t\ttop = Math.max(top, layers.offsetTop);\n\t\t}\n\t\treturn top;\n\t}\n\tprivate _handleWindowResize() {\n\t\tif (this.element.length === 0) return;\n\t\tlet max: number;\n\t\tlet cols: number;\n\n\t\tconst position = SETTINGS.get<string>('position');\n\t\tthis.element.addClass(position);\n\t\tswitch (position) {\n\t\t\tcase 'top': {\n\t\t\t\tthis.element[0].style.marginTop = this.getTopHeight(false) + 'px';\n\t\t\t\tthis.element[0].style.marginLeft = this.getLeftWidth() + 'px';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'left': {\n\t\t\t\tconst controls = document.querySelector<HTMLElement>('#ui-left > #controls');\n\t\t\t\tthis.element[0].style.height = `${controls.offsetHeight}px`;\n\t\t\t\tmax = Math.floor(controls.offsetHeight / ControlManager.CONTROL_WIDTH);\n\t\t\t\tcols = Math.ceil(this.groups.length / max);\n\t\t\t\tthis.element.find('.group-tools').css('margin-left', `${(cols - 1) * (ControlManager.CONTROL_WIDTH + 2)}px`);\n\t\t\t\tthis.element[0].style.marginTop = this.getTopHeight(true) + 'px';\n\t\t\t\tthis.element[0].style.marginLeft = this.getLeftWidth() + 'px';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'bottom': {\n\t\t\t\tthis.element[0].style.left = (document.getElementById(\"ui-middle\").offsetLeft +\n\t\t\t\t\tdocument.getElementById(\"hotbar-directory-controls\").offsetLeft) + 'px';\n\t\t\t\tthis.element[0].style.bottom = (document.getElementById('hotbar').offsetHeight + 10) + 'px';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'right': default: {\n\t\t\t\tmax = Math.floor(this.element[0].offsetHeight / ControlManager.CONTROL_WIDTH);\n\t\t\t\tcols = Math.ceil(this.groups.length / max);\n\t\t\t\tthis.element.find('.group-tools').css('margin-right', `${(cols - 1) * (ControlManager.CONTROL_WIDTH + 2)}px`);\n\t\t\t\tthis.element[0].style.top = document.getElementById(\"sidebar-tabs\").offsetTop + 'px';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tasync activateGroupByName(groupName: string) {\n\t\tconst group = this.groups.find(x => x.name === groupName);\n\t\tif (!group) {\n\t\t\tconsole.warn(`ControlManager::activateGroupByName > Attempted to activate ToolGroup with non-existant name '${groupName}'`);\n\t\t\treturn;\n\t\t}\n\t\tif (group.button || group.toggle) {\n\t\t\tconsole.warn(`ControlManager::activateGroupByName > Attempted to activate ToolGroup that is either a button or toggle`);\n\t\t\treturn;\n\t\t}\n\t\tif (this.activeGroupName === groupName) {\n\t\t\tthis.refresh();\n\t\t\treturn;\n\t\t}\n\t\tconst prevGroup = this.activeGroup;\n\t\tthis.activeGroupName = groupName;\n\t\t// Deactivate previous group\n\t\tif (prevGroup) {\n\t\t\tprevGroup.isActive = false;\n\t\t\tawait this._invokeHandler(prevGroup.onClick, prevGroup, false);\n\t\t}\n\t\t// Activate new group\n\t\tgroup.isActive = true;\n\t\tawait this._invokeHandler(group.onClick, group, true);\n\t\tthis.refresh();\n\t\tHooks.callAll(\"toolGroupActivated\", this, group);\n\t}\n\tasync activateToolByName(groupName: string, toolName: string, activateGroup: boolean = true) {\n\t\tconst group = this.groups.find(x => x.name === groupName);\n\t\tif (!group) {\n\t\t\tconsole.warn(`ControlManager::activateToolByName > Attempted to activate ToolGroup with non-existant name '${groupName}'`);\n\t\t\treturn;\n\t\t}\n\t\tconst tool = group.tools.find(x => x.name === toolName);\n\t\tif (!tool) {\n\t\t\tconsole.warn(`ControlManager::activateToolByName > Attempted to activate Tool with non-existant name '${toolName}'`);\n\t\t\treturn;\n\t\t}\n\t\tif (tool.button || tool.toggle) {\n\t\t\tconsole.warn(`ControlManager::activateToolByName > Attempted to activate Tool that is either a button or toggle`);\n\t\t\treturn;\n\t\t}\n\t\tif (group.activeTool === toolName) {\n\t\t\tthis.refresh();\n\t\t\treturn;\n\t\t}\n\t\tconst prevTool = group.tools.find(x => x.name === group.activeTool);\n\t\tgroup.activeTool = toolName;\n\t\t// Deactivate previous group\n\t\tif (prevTool) {\n\t\t\tprevTool.isActive = false;\n\t\t\tawait this._invokeHandler(prevTool.onClick, prevTool, false);\n\t\t}\n\t\t// Activate new group\n\t\ttool.isActive = true;\n\t\tawait this._invokeHandler(tool.onClick, tool, true);\n\t\tif (activateGroup && this.activeGroupName !== groupName) {\n\t\t\tthis.activateGroupByName(groupName);\n\t\t}\n\t\telse if (this.activeGroupName === groupName) {\n\t\t\tthis.refresh();\n\t\t}\n\t\tHooks.callAll(\"toolActivated\", this, group, tool);\n\t}\n\treloadModuleButtons() {\n\t\tHooks.callAll(\"moduleButtonsReloading\", this);\n\t\t// Notify the current group that they are now disabled before we rebuild\n\t\tconst currentGroup = this.activeGroup;\n\t\tthis._invokeHandler(currentGroup?.onClick, currentGroup, false);\n\t\t// Notify all selected tools of being deactivated\n\t\tfor (const group of this._groups) {\n\t\t\tconst currentTool = group.activeTool && group.tools ? group.tools.find(x => x.name === group.activeTool) : undefined;\n\t\t\tthis._invokeHandler(currentTool?.onClick, currentTool, false);\n\t\t}\n\t\t(<ControlManager>(<any>ui).moduleControls).initialize();\n\t\t(<ControlManager>(<any>ui).moduleControls).render();\n\t}\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import SETTINGS from \"../../common/Settings\";\nimport ControlManagerImpl from \"./ControlManager\";\n\nSETTINGS.init('lib-df-buttons');\n\nHooks.once('init', () => {\n\t(<any>ui).moduleControls = new ControlManagerImpl();\n\n\tSETTINGS.register('position', {\n\t\tscope: 'client',\n\t\tchoices: {\n\t\t\tright: 'LIB_DF_BUTTONS.choices.right',\n\t\t\tleft: 'LIB_DF_BUTTONS.choices.left',\n\t\t\ttop: 'LIB_DF_BUTTONS.choices.top',\n\t\t\tbottom: 'LIB_DF_BUTTONS.choices.bottom'\n\t\t},\n\t\tname: 'LIB_DF_BUTTONS.name',\n\t\thint: 'LIB_DF_BUTTONS.hint',\n\t\tconfig: false,\n\t\tdefault: 'left',\n\t\tonChange: () => (<ControlManagerImpl>(<any>ui).moduleControls).render()\n\t});\n\n\t// Soft Dependency on `libwrapper`. Only use it if it already exists\n\tif (game.modules.get('libWrapper')?.active) {\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'Sidebar.prototype.expand', function (this: Sidebar, wrapped: AnyFunction) {\n\t\t\tHooks.callAll('collapseSidebarPre', this, !this._collapsed);\n\t\t\twrapped();\n\t\t}, 'WRAPPER');\n\t\tlibWrapper.register(SETTINGS.MOD_NAME, 'Sidebar.prototype.collapse', function (this: Sidebar, wrapped: AnyFunction) {\n\t\t\tHooks.callAll('collapseSidebarPre', this, !this._collapsed);\n\t\t\twrapped();\n\t\t}, 'WRAPPER');\n\t}// Otherwise do the traditional style of monkey-patch wrapper\n\telse {\n\t\t(<any>Sidebar.prototype).expand_ORIG = Sidebar.prototype.expand;\n\t\tSidebar.prototype.expand = function (this: Sidebar) {\n\t\t\tHooks.callAll('collapseSidebarPre', this, !this._collapsed);\n\t\t\t(<any>Sidebar.prototype).expand_ORIG.bind(this)();\n\t\t};\n\t\t(<any>Sidebar.prototype).collapse_ORIG = Sidebar.prototype.collapse;\n\t\tSidebar.prototype.collapse = function (this: Sidebar) {\n\t\t\tHooks.callAll('collapseSidebarPre', this, !this._collapsed);\n\t\t\t(<any>Sidebar.prototype).collapse_ORIG.bind(this)();\n\t\t};\n\t}\n});\nHooks.once('setup', () => {\n\t(<ControlManagerImpl>(<any>ui).moduleControls).initialize();\n});\nHooks.once('ready', () => {\n\t(<ControlManagerImpl>(<any>ui).moduleControls).render(true);\n});\n/* Example code for appending ToolGroups and Tools */\n/**\n//import { Tool, ToolGroup } from \"./ToolType\";\nHooks.on('getModuleToolGroups', (app: ControlManager, groups: ToolGroup[]) => {\n\tconst handleClick = function (this: Tool, active?: boolean) {\n\t\tif (active !== undefined)\n\t\t\tconsole.log(`${this.name}: active=${active}`);\n\t\telse\n\t\t\tconsole.log(this.name);\n\t};\n\tgroups.push({\n\t\tname: 'radial1',\n\t\ticon: '<i class=\"fas fa-dice-one\"></i>',\n\t\ttitle: 'radial1',\n\t\tvisible: () => ui.controls.activeControl === 'token',\n\t\tonClick: handleClick,\n\t\ttools: [\n\t\t\t{ name: 'tool1-1', title: 'tool1-1', onClick: handleClick, icon: '<i class=\"fas fa-dice-one\"></i>' },\n\t\t\t{ name: 'tool1-2', title: 'tool1-2', onClick: handleClick, icon: '<i class=\"fas fa-dice-one\"></i>' },\n\t\t\t{ name: 'tool1-3', title: 'tool1-3', onClick: handleClick, icon: '<i class=\"fas fa-dice-one\"></i>', button: true },\n\t\t\t{ name: 'tool1-4', title: 'tool1-4', onClick: handleClick, icon: '<i class=\"fas fa-dice-one\"></i>', toggle: true },\n\t\t]\n\t});\n\tgroups.push({\n\t\tname: 'radial2',\n\t\ticon: '<i class=\"fas fa-dice-two\"></i>',\n\t\ttitle: 'radial2',\n\t\tvisible: () => ui.controls.activeControl === 'walls',\n\t\tonClick: handleClick,\n\t\ttools: [\n\t\t\t{ name: 'tool2-1', title: 'tool2-1', onClick: handleClick, icon: '<i class=\"fas fa-dice-two\"></i>' },\n\t\t\t{ name: 'tool2-2', title: 'tool2-2', onClick: handleClick, icon: '<i class=\"fas fa-dice-two\"></i>' },\n\t\t\t{ name: 'tool2-3', title: 'tool2-3', onClick: handleClick, icon: '<i class=\"fas fa-dice-two\"></i>', button: true },\n\t\t\t{ name: 'tool2-4', title: 'tool2-4', onClick: handleClick, icon: '<i class=\"fas fa-dice-two\"></i>', toggle: true },\n\t\t]\n\t});\n\tgroups.push({\n\t\tname: 'radial3',\n\t\ticon: '<i class=\"fas fa-dice-three\"></i>',\n\t\ttitle: 'radial3',\n\t\tonClick: handleClick,\n\t\ttools: [\n\t\t\t{ name: 'tool3-1', title: 'tool3-1', onClick: handleClick, icon: '<i class=\"fas fa-dice-three\"></i>' },\n\t\t\t{ name: 'tool3-2', title: 'tool3-2', onClick: handleClick, icon: '<i class=\"fas fa-dice-three\"></i>' },\n\t\t\t{ name: 'tool3-3', title: 'tool3-3', onClick: handleClick, icon: '<i class=\"fas fa-dice-three\"></i>', button: true },\n\t\t\t{ name: 'tool3-4', title: 'tool3-4', onClick: handleClick, icon: '<i class=\"fas fa-dice-three\"></i>', toggle: true },\n\t\t]\n\t});\n\tgroups.push({\n\t\tname: 'button1',\n\t\ticon: '<i class=\"fas fa-dice-one\"></i>',\n\t\ttitle: 'button1',\n\t\tbutton: true,\n\t\tonClick: handleClick,\n\t});\n\tgroups.push({\n\t\tname: 'button2',\n\t\ticon: '<i class=\"fas fa-dice-two\"></i>',\n\t\ttitle: 'button2',\n\t\tbutton: true,\n\t\tonClick: handleClick,\n\t});\n\n\tgroups.push({\n\t\tname: 'toggle1',\n\t\ticon: '<i class=\"fas fa-dice-one\"></i>',\n\t\ttitle: 'toggle1',\n\t\ttoggle: true,\n\t\tonClick: handleClick,\n\t});\n\tgroups.push({\n\t\tname: 'toggle2',\n\t\ticon: '<i class=\"fas fa-dice-two\"></i>',\n\t\ttitle: 'toggle2',\n\t\ttoggle: true,\n\t\tisActive: true,\n\t\tonClick: handleClick,\n\t});\n});\n/**/"],"names":["SETTINGS","static","moduleName","this","MOD_NAME","String","prototype","localize","game","i18n","valueOf","key","config","settings","register","registerMenu","get","value","set","default","Object","ControlManager","Application","initializationIncomplete","magnetMenu","hooksRegister","field","invertFalsey","Function","groups","_groups","activeGroupName","_activeGroupName","activeToolName","group","activeGroup","activeTool","find","c","name","tools","t","defaultOptions","mergeObject","super","width","id","template","popOut","resizable","control","undefined","active","isActive","toggle","button","visible","onClick","async","_getModuleToolGroups","Hooks","on","_handleSidebarCollapse","bind","activateGroupByName","activateToolByName","reloadModuleButtons","refresh","_handleWindowResize","window","addEventListener","initializeFields","checkBoolean","currentGroup","_invokeHandler","tool","currentTool","render","callAll","_","length","singleGroup","noCanvas","groupUI","icon","title","class","push","every","x","firstGroup","activateListeners","html","_onClickGroup","_onClickTool","$","renderTemplate","event","remove","currentTarget","classList","append","handler","owner","preventDefault","groupName","dataset","newState","li","toolName","_injectHTML","_element","force","options","completeInitialization","ready","_render","ui","sidebar","_collapsed","element","css","removeAttribute","add","close","off","removeEventListener","sideBar","collapsed","collapsedSize","expandedSize","shouldAnimate","offsetWidth","delay","animate","right","style","getLeftWidth","cols","sceneTools","document","querySelector","max","Math","floor","offsetHeight","CONTROL_HEIGHT","ceil","childElementCount","CONTROL_WIDTH","getTopHeight","magnetToSceneControls","uiTop","top","offsetTop","layers","position","addClass","marginTop","marginLeft","controls","height","left","getElementById","offsetLeft","bottom","console","warn","prevGroup","activateGroup","prevTool","moduleControls","initialize","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","o","defineProperty","enumerable","obj","prop","hasOwnProperty","call","r","Symbol","toStringTag","once","scope","choices","hint","onChange","modules","libWrapper","wrapped","Sidebar","expand_ORIG","expand","collapse_ORIG","collapse"],"sourceRoot":""}